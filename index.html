<html lang="pt-BR">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Life Organizer - Seu Sistema de Organização Pessoal
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <style>
   :root {
        --primary: #4f46e5;
        --secondary: #10b981;
        --dark: #1f2937;
        --light: #f3f4f6;
      }

      .drag-area {
        border: 2px dashed #ccc;
        transition: all 0.3s;
      }

      .drag-area.active {
        border-color: var(--primary);
        background-color: rgba(79, 70, 229, 0.05);
      }

      .note-card {
        transition: all 0.2s;
      }

      .note-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      .task-item:hover .task-actions {
        opacity: 1;
      }

      .task-actions {
        opacity: 0;
        transition: opacity 0.2s;
      }

      .fade-in {
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #spreadsheet {
        overflow-x: auto;
      }

      #spreadsheet table {
        min-width: 100%;
      }

      #spreadsheet th,
      #spreadsheet td {
        border: 1px solid #e5e7eb;
        padding: 8px 12px;
        min-width: 120px;
      }

      #spreadsheet th {
        background-color: #f9fafb;
        font-weight: 600;
      }

      #spreadsheet td:focus {
        outline: 2px solid var(--primary);
        background-color: white;
      }
  </style>
 </head>
 <body class="bg-gray-50">
  <div class="min-h-screen flex flex-col">
   <!-- Header -->
   <header class="bg-indigo-600 text-white shadow-md">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
     <div class="flex items-center space-x-2">
      <i class="fas fa-clipboard-list text-2xl">
      </i>
      <h1 class="text-2xl font-bold">
       Life Organizer
      </h1>
     </div>
     <div class="flex items-center space-x-4">
      <button class="p-2 rounded-full hover:bg-indigo-700" id="toggleTheme">
       <i class="fas fa-moon">
       </i>
      </button>
      <div class="relative">
       <button class="flex items-center space-x-2 focus:outline-none" id="userMenuButton">
        <img alt="Foto de perfil do usuário, rosto sorridente, fundo neutro" class="w-8 h-8 rounded-full" height="40" src="https://storage.googleapis.com/a1aa/image/e84dbaf5-ea13-485d-38ad-366eca7e4692.jpg" width="40"/>
        <span>
         Usuário
        </span>
       </button>
       <div class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10" id="userMenu">
        <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" href="#">
         Configurações
        </a>
        <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" href="#">
         Sair
        </a>
       </div>
      </div>
     </div>
    </div>
   </header>
   <!-- Main Content -->
   <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <aside aria-label="Sidebar" class="w-64 bg-white shadow-md flex-shrink-0 hidden md:block">
     <nav class="h-full overflow-y-auto p-4">
      <div class="mb-6">
       <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
        Áreas da Vida
       </h2>
       <ul id="lifeAreas">
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-indigo-700 bg-indigo-50" href="#carreira">
          <i class="fas fa-briefcase mr-3">
          </i>
          Carreira
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#saude">
          <i class="fas fa-heartbeat mr-3">
          </i>
          Saúde
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#financas">
          <i class="fas fa-money-bill-wave mr-3">
          </i>
          Finanças
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#relacionamentos">
          <i class="fas fa-users mr-3">
          </i>
          Relacionamentos
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#desenvolvimento">
          <i class="fas fa-graduation-cap mr-3">
          </i>
          Desenvolvimento Pessoal
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#casa-familia">
          <i class="fas fa-home mr-3">
          </i>
          Casa &amp; Família
         </a>
        </li>
        <li class="mb-1">
         <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#lazer-diversao">
          <i class="fas fa-umbrella-beach mr-3">
          </i>
          Lazer &amp; Diversão
         </a>
        </li>
       </ul>
      </div>
      <div class="mb-6">
       <button class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-md hover:bg-indigo-100" id="addAreaBtn">
        <i class="fas fa-plus mr-2">
        </i>
        Adicionar Área
       </button>
      </div>
      <div>
       <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
        Dashboard
       </h2>
       <ul>
        <li class="mb-1">
         <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#dashboard">
          <i class="fas fa-chart-pie mr-3">
          </i>
          Visão Geral
         </a>
        </li>
        <li class="mb-1">
         <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#tarefas" id="tasksTabLink">
          <i class="fas fa-tasks mr-3">
          </i>
          Tarefas
         </a>
        </li>
        <li class="mb-1">
         <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#planilhas" id="spreadsheetTabLink">
          <i class="fas fa-table mr-3">
          </i>
          Planilhas
         </a>
        </li>
        <li class="mb-1">
         <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#notas" id="notesTabLink">
          <i class="fas fa-sticky-note mr-3">
          </i>
          Notas
         </a>
        </li>
       </ul>
      </div>
     </nav>
    </aside>
    <!-- Mobile Sidebar Toggle -->
    <button aria-label="Abrir menu" class="md:hidden fixed bottom-6 right-6 z-50 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg flex items-center justify-center" id="mobileMenuButton">
     <i class="fas fa-bars text-xl">
     </i>
    </button>
    <!-- Mobile Sidebar -->
    <aside aria-label="Menu móvel" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-40 hidden transition-opacity" id="mobileSidebar">
     <div class="relative w-80 h-full bg-white shadow-xl">
      <button aria-label="Fechar menu" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700" id="closeMobileMenu">
       <i class="fas fa-times text-xl">
       </i>
      </button>
      <nav class="h-full p-4 pt-12 overflow-y-auto">
       <div class="mb-6">
        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
         Áreas da Vida
        </h2>
        <ul id="mobileLifeAreas">
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-indigo-700 bg-indigo-50" href="#carreira">
           <i class="fas fa-briefcase mr-3">
           </i>
           Carreira
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#saude">
           <i class="fas fa-heartbeat mr-3">
           </i>
           Saúde
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#financas">
           <i class="fas fa-money-bill-wave mr-3">
           </i>
           Finanças
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#relacionamentos">
           <i class="fas fa-users mr-3">
           </i>
           Relacionamentos
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#desenvolvimento">
           <i class="fas fa-graduation-cap mr-3">
           </i>
           Desenvolvimento Pessoal
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#casa-familia">
           <i class="fas fa-home mr-3">
           </i>
           Casa &amp; Família
          </a>
         </li>
         <li class="mb-1">
          <a class="area-link flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#lazer-diversao">
           <i class="fas fa-umbrella-beach mr-3">
           </i>
           Lazer &amp; Diversão
          </a>
         </li>
        </ul>
       </div>
       <div class="mb-6">
        <button class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-md hover:bg-indigo-100" id="mobileAddAreaBtn">
         <i class="fas fa-plus mr-2">
         </i>
         Adicionar Área
        </button>
       </div>
       <div>
        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">
         Dashboard
        </h2>
        <ul>
         <li class="mb-1">
          <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#dashboard">
           <i class="fas fa-chart-pie mr-3">
           </i>
           Visão Geral
          </a>
         </li>
         <li class="mb-1">
          <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#tarefas" id="mobileTasksTabLink">
           <i class="fas fa-tasks mr-3">
           </i>
           Tarefas
          </a>
         </li>
         <li class="mb-1">
          <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#planilhas" id="mobileSpreadsheetTabLink">
           <i class="fas fa-table mr-3">
           </i>
           Planilhas
          </a>
         </li>
         <li class="mb-1">
          <a class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50" href="#notas" id="mobileNotesTabLink">
           <i class="fas fa-sticky-note mr-3">
           </i>
           Notas
          </a>
         </li>
        </ul>
       </div>
      </nav>
     </div>
    </aside>
    <!-- Main Panel -->
    <main class="flex-1 overflow-y-auto" tabindex="0">
     <!-- Dashboard View -->
     <section class="p-4 md:p-8" id="dashboardView">
      <div class="mb-8">
       <h2 class="text-2xl font-bold text-gray-800 mb-2">
        Visão Geral
       </h2>
       <p class="text-gray-600">
        Organize todas as áreas da sua vida em um só lugar.
       </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
       <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
         <h3 class="text-lg font-semibold text-gray-800">
          Tarefas Pendentes
         </h3>
         <div class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium">
          12
         </div>
        </div>
        <p class="mt-2 text-gray-600">
         Prioridade alta: 4
        </p>
       </div>
       <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
         <h3 class="text-lg font-semibold text-gray-800">
          Planilhas
         </h3>
         <div class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium">
          5
         </div>
        </div>
        <p class="mt-2 text-gray-600">
         Modificadas hoje: 2
        </p>
       </div>
       <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
         <h3 class="text-lg font-semibold text-gray-800">
          Áreas da Vida
         </h3>
         <div class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">
          7
         </div>
        </div>
        <p class="mt-2 text-gray-600">
         Personalizadas: 0
        </p>
       </div>
       <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
         <h3 class="text-lg font-semibold text-gray-800">
          Notas
         </h3>
         <div class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium">
          14
         </div>
        </div>
        <p class="mt-2 text-gray-600">
         Editadas recentemente
        </p>
       </div>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
       <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="p-4 border-b border-gray-200">
         <h3 class="text-lg font-semibold text-gray-800">
          Tarefas Recentes
         </h3>
        </div>
        <ul class="divide-y divide-gray-200">
         <li class="p-4 hover:bg-gray-50">
          <div class="flex items-start">
           <input class="mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
           <div class="ml-3 flex-1">
            <p class="text-sm font-medium text-gray-900">
             Revisar metas trimestrais
            </p>
            <p class="text-sm text-gray-500 mt-1">
             Carreira • Amanhã
            </p>
           </div>
          </div>
         </li>
         <li class="p-4 hover:bg-gray-50">
          <div class="flex items-start">
           <input class="mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
           <div class="ml-3 flex-1">
            <p class="text-sm font-medium text-gray-900">
             Marcar consulta médica
            </p>
            <p class="text-sm text-gray-500 mt-1">
             Saúde • Próximos dias
            </p>
           </div>
          </div>
         </li>
         <li class="p-4 hover:bg-gray-50">
          <div class="flex items-start">
           <input class="mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
           <div class="ml-3 flex-1">
            <p class="text-sm font-medium text-gray-900">
             Pagar conta de luz
            </p>
            <p class="text-sm text-gray-500 mt-1">
             Finanças • Hoje
            </p>
           </div>
          </div>
         </li>
        </ul>
        <div class="p-4 bg-gray-50">
         <a class="text-sm font-medium text-indigo-600 hover:text-indigo-500" href="#tarefas" id="viewAllTasksBtn">
          Ver todas as tarefas →
         </a>
        </div>
       </div>
       <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="p-4 border-b border-gray-200">
         <h3 class="text-lg font-semibold text-gray-800">
          Notas Recentes
         </h3>
        </div>
        <ul class="divide-y divide-gray-200">
         <li class="p-4 hover:bg-gray-50">
          <h4 class="text-sm font-medium text-indigo-600">
           Ideias para projeto pessoal
          </h4>
          <p class="text-sm text-gray-500 mt-1 truncate">
           Começar a planejar um novo projeto de desenvolvimento pessoal
                    que ajude a organizar melhor meu tempo e objetivos...
          </p>
          <p class="text-xs text-gray-400 mt-2">
           Ontem
          </p>
         </li>
         <li class="p-4 hover:bg-gray-50">
          <h4 class="text-sm font-medium text-indigo-600">
           Livros para ler
          </h4>
          <p class="text-sm text-gray-500 mt-1 truncate">
           Lista de livros interessantes sobre produtividade e
                    desenvolvimento pessoal...
          </p>
          <p class="text-xs text-gray-400 mt-2">
           2 dias atrás
          </p>
         </li>
         <li class="p-4 hover:bg-gray-50">
          <h4 class="text-sm font-medium text-indigo-600">
           Metas financeiras
          </h4>
          <p class="text-sm text-gray-500 mt-1 truncate">
           Estabelecer objetivos claros para os próximos 6 meses em
                    relação a economias e investimentos...
          </p>
          <p class="text-xs text-gray-400 mt-2">
           3 dias atrás
          </p>
         </li>
        </ul>
        <div class="p-4 bg-gray-50">
         <a class="text-sm font-medium text-indigo-600 hover:text-indigo-500" href="#notas" id="viewAllNotesBtn">
          Ver todas as notas →
         </a>
        </div>
       </div>
      </div>
     </section>
     <!-- Tasks View -->
     <section class="hidden p-4 md:p-8" id="tasksView">
      <div class="mb-8">
       <div class="flex justify-between items-center mb-2">
        <h2 class="text-2xl font-bold text-gray-800">
         Tarefas
        </h2>
        <button class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" id="addTaskBtn">
         <i class="fas fa-plus mr-2">
         </i>
         Nova Tarefa
        </button>
       </div>
       <p class="text-gray-600">
        Organize suas tarefas por área da vida e prioridade.
       </p>
      </div>
      <div class="flex flex-wrap mb-6 gap-2">
       <button class="task-filter-btn px-3 py-1 bg-indigo-100 text-indigo-700 text-sm font-medium rounded-full hover:bg-indigo-200" data-filter="all">
        Todas
       </button>
       <button class="task-filter-btn px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200" data-filter="career">
        Carreira
       </button>
       <button class="task-filter-btn px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200" data-filter="health">
        Saúde
       </button>
       <button class="task-filter-btn px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200" data-filter="finance">
        Finanças
       </button>
       <button class="task-filter-btn px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200" data-filter="high-priority">
        Prioridade Alta
       </button>
       <button class="task-filter-btn px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200" data-filter="today">
        Hoje
       </button>
      </div>
      <div class="bg-white rounded-lg shadow overflow-hidden">
       <div class="grid grid-cols-12 bg-gray-50 p-4 border-b border-gray-200 font-medium text-xs text-gray-500 uppercase tracking-wider">
        <div class="col-span-1">
        </div>
        <div class="col-span-5">
         Tarefa
        </div>
        <div class="col-span-2">
         Área
        </div>
        <div class="col-span-2">
         Prazo
        </div>
        <div class="col-span-2">
         Ações
        </div>
       </div>
       <ul class="divide-y divide-gray-200" id="taskList">
        <li class="task-item p-4 hover:bg-gray-50" data-area="career" data-due="today" data-priority="high">
         <div class="grid grid-cols-12 gap-2 items-center">
          <div class="col-span-1 flex items-center">
           <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
          </div>
          <div class="col-span-5">
           <p class="text-sm font-medium text-gray-900">
            Finalizar relatório trimestral
           </p>
           <p class="text-sm text-gray-500 mt-1">
            Enviar para revisão antes da reunião
           </p>
          </div>
          <div class="col-span-2">
           <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
            Carreira
           </span>
          </div>
          <div class="col-span-2">
           <span class="text-sm text-red-600 font-medium">
            Hoje
           </span>
          </div>
          <div class="col-span-2 task-actions flex justify-end space-x-2">
           <button class="text-indigo-600 hover:text-indigo-900">
            <i class="fas fa-edit">
            </i>
           </button>
           <button class="text-red-600 hover:text-red-900">
            <i class="fas fa-trash">
            </i>
           </button>
          </div>
         </div>
        </li>
        <li class="task-item p-4 hover:bg-gray-50" data-area="health" data-due="tomorrow" data-priority="medium">
         <div class="grid grid-cols-12 gap-2 items-center">
          <div class="col-span-1 flex items-center">
           <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
          </div>
          <div class="col-span-5">
           <p class="text-sm font-medium text-gray-900">
            Marcar consulta médica
           </p>
           <p class="text-sm text-gray-500 mt-1">
            Check-up anual
           </p>
          </div>
          <div class="col-span-2">
           <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
            Saúde
           </span>
          </div>
          <div class="col-span-2">
           <span class="text-sm text-orange-600 font-medium">
            Amanhã
           </span>
          </div>
          <div class="col-span-2 task-actions flex justify-end space-x-2">
           <button class="text-indigo-600 hover:text-indigo-900">
            <i class="fas fa-edit">
            </i>
           </button>
           <button class="text-red-600 hover:text-red-900">
            <i class="fas fa-trash">
            </i>
           </button>
          </div>
         </div>
        </li>
        <li class="task-item p-4 hover:bg-gray-50" data-area="finance" data-due="today" data-priority="high">
         <div class="grid grid-cols-12 gap-2 items-center">
          <div class="col-span-1 flex items-center">
           <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
          </div>
          <div class="col-span-5">
           <p class="text-sm font-medium text-gray-900">
            Pagar conta de luz
           </p>
           <p class="text-sm text-gray-500 mt-1">
            Vencimento hoje
           </p>
          </div>
          <div class="col-span-2">
           <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
            Finanças
           </span>
          </div>
          <div class="col-span-2">
           <span class="text-sm text-red-600 font-medium">
            Hoje
           </span>
          </div>
          <div class="col-span-2 task-actions flex justify-end space-x-2">
           <button class="text-indigo-600 hover:text-indigo-900">
            <i class="fas fa-edit">
            </i>
           </button>
           <button class="text-red-600 hover:text-red-900">
            <i class="fas fa-trash">
            </i>
           </button>
          </div>
         </div>
        </li>
        <li class="task-item p-4 hover:bg-gray-50" data-area="relationships" data-due="week" data-priority="low">
         <div class="grid grid-cols-12 gap-2 items-center">
          <div class="col-span-1 flex items-center">
           <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" type="checkbox"/>
          </div>
          <div class="col-span-5">
           <p class="text-sm font-medium text-gray-900">
            Ligar para mãe
           </p>
           <p class="text-sm text-gray-500 mt-1">
            Conversar sobre visita no fim de semana
           </p>
          </div>
          <div class="col-span-2">
           <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
            Relacionamentos
           </span>
          </div>
          <div class="col-span-2">
           <span class="text-sm text-gray-600 font-medium">
            Essa semana
           </span>
          </div>
          <div class="col-span-2 task-actions flex justify-end space-x-2">
           <button class="text-indigo-600 hover:text-indigo-900">
            <i class="fas fa-edit">
            </i>
           </button>
           <button class="text-red-600 hover:text-red-900">
            <i class="fas fa-trash">
            </i>
           </button>
          </div>
         </div>
        </li>
       </ul>
       <div class="p-4 border-t border-gray-200 bg-gray-50">
        <button class="text-sm font-medium text-indigo-600 hover:text-indigo-500" id="loadMoreTasksBtn">
         Carregar mais tarefas ↓
        </button>
       </div>
      </div>
     </section>
     <!-- Add Task Modal -->
     <div aria-labelledby="addTaskModalTitle" aria-modal="true" class="fixed inset-0 overflow-y-auto z-50 hidden" id="addTaskModal" role="dialog">
      <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
       <div aria-hidden="true" class="fixed inset-0 transition-opacity">
        <div class="absolute inset-0 bg-gray-500 opacity-75">
        </div>
       </div>
       <span aria-hidden="true" class="hidden sm:inline-block sm:align-middle sm:h-screen">
        ​
       </span>
       <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
         <div class="sm:flex sm:items-start">
          <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
           <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4" id="addTaskModalTitle">
            Adicionar Nova Tarefa
           </h3>
           <div class="mt-2">
            <div class="mb-4">
             <label class="block text-sm font-medium text-gray-700 mb-1" for="taskTitle">
              Título
             </label>
             <input class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="taskTitle" type="text"/>
            </div>
            <div class="mb-4">
             <label class="block text-sm font-medium text-gray-700 mb-1" for="taskDescription">
              Descrição
             </label>
             <textarea class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="taskDescription" rows="3"></textarea>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-4">
             <div>
              <label class="block text-sm font-medium text-gray-700 mb-1" for="taskArea">
               Área
              </label>
              <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="taskArea">
               <option value="career">
                Carreira
               </option>
               <option value="health">
                Saúde
               </option>
               <option value="finance">
                Finanças
               </option>
               <option value="relationships">
                Relacionamentos
               </option>
               <option value="personal">
                Desenvolvimento Pessoal
               </option>
               <option value="home">
                Casa &amp; Família
               </option>
               <option value="leisure">
                Lazer &amp; Diversão
               </option>
              </select>
             </div>
             <div>
              <label class="block text-sm font-medium text-gray-700 mb-1" for="taskPriority">
               Prioridade
              </label>
              <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="taskPriority">
               <option value="high">
                Alta
               </option>
               <option value="medium">
                Média
               </option>
               <option value="low">
                Baixa
               </option>
              </select>
             </div>
            </div>
            <div class="mb-4">
             <label class="block text-sm font-medium text-gray-700 mb-1" for="taskDueDate">
              Prazo
             </label>
             <input class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="taskDueDate" type="date"/>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
         <button class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm" id="saveTaskBtn" type="button">
          Salvar Tarefa
         </button>
         <button class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" id="cancelTaskBtn" type="button">
          Cancelar
         </button>
        </div>
       </div>
      </div>
     </div>
     <!-- Spreadsheet View -->
     <section class="hidden p-4 md:p-8" id="spreadsheetView">
      <div class="mb-8">
       <div class="flex justify-between items-center mb-2">
        <h2 class="text-2xl font-bold text-gray-800">
         Planilhas
        </h2>
        <div class="flex space-x-2">
         <button class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" id="addSpreadsheetBtn">
          <i class="fas fa-plus mr-2">
          </i>
          Nova Planilha
         </button>
         <button class="px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" id="exportSpreadsheetBtn">
          <i class="fas fa-download mr-2">
          </i>
          Exportar
         </button>
        </div>
       </div>
       <p class="text-gray-600">
        Crie e gerencie suas planilhas pessoais.
       </p>
      </div>
      <div class="flex mb-6 space-x-2">
       <button class="px-3 py-1 bg-indigo-100 text-indigo-700 text-sm font-medium rounded-full">
        Todas
       </button>
       <button class="px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200">
        Recentes
       </button>
       <button class="px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200">
        Carreira
       </button>
       <button class="px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full hover:bg-gray-200">
        Finanças
       </button>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6" id="spreadsheetList">
       <div aria-label="Abrir planilha Orçamento Mensal" aria-pressed="false" class="bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow" data-spreadsheet="orcamento-mensal" role="button" tabindex="0">
        <div class="p-4">
         <div class="flex justify-between items-start">
          <h3 class="text-lg font-semibold text-gray-800">
           Orçamento Mensal
          </h3>
          <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">
           Finanças
          </span>
         </div>
         <p class="text-sm text-gray-500 mt-2">
          Controle de receitas e despesas
         </p>
         <p class="text-xs text-gray-400 mt-3">
          Modificado há 2 dias
         </p>
        </div>
       </div>
       <div aria-label="Abrir planilha Metas Profissionais" aria-pressed="false" class="bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow" data-spreadsheet="metas-profissionais" role="button" tabindex="0">
        <div class="p-4">
         <div class="flex justify-between items-start">
          <h3 class="text-lg font-semibold text-gray-800">
           Metas Profissionais
          </h3>
          <span class="text-xs bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full">
           Carreira
          </span>
         </div>
         <p class="text-sm text-gray-500 mt-2">
          Objetivos e progresso
         </p>
         <p class="text-xs text-gray-400 mt-3">
          Modificado semana passada
         </p>
        </div>
       </div>
       <div aria-label="Abrir planilha Plano de Estudos" aria-pressed="false" class="bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow" data-spreadsheet="plano-de-estudos" role="button" tabindex="0">
        <div class="p-4">
         <div class="flex justify-between items-start">
          <h3 class="text-lg font-semibold text-gray-800">
           Plano de Estudos
          </h3>
          <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">
           Desenvolvimento
          </span>
         </div>
         <p class="text-sm text-gray-500 mt-2">
          Cronograma e recursos
         </p>
         <p class="text-xs text-gray-400 mt-3">
          Modificado ontem
         </p>
        </div>
       </div>
      </div>
      <div aria-live="polite" class="bg-white rounded-lg shadow overflow-hidden hidden" id="spreadsheetEditor">
       <div class="flex justify-between items-center p-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-800" id="spreadsheetTitle">
         Nova Planilha
        </h3>
        <div class="flex space-x-2">
         <button aria-label="Renomear planilha" class="text-gray-500 hover:text-gray-700" id="renameSpreadsheetBtn">
          <i class="fas fa-edit">
          </i>
         </button>
         <button aria-label="Salvar planilha" class="text-green-600 hover:text-green-800" id="saveSpreadsheetBtn">
          <i class="fas fa-save">
          </i>
         </button>
         <button aria-label="Fechar editor de planilha" class="text-red-600 hover:text-red-800" id="closeSpreadsheetBtn">
          <i class="fas fa-times">
          </i>
         </button>
        </div>
       </div>
       <div class="overflow-auto" id="spreadsheet">
        <table aria-label="Planilha de dados" class="w-full" role="grid">
         <thead>
          <tr>
           <th scope="col">
           </th>
           <th scope="col">
            A
           </th>
           <th scope="col">
            B
           </th>
           <th scope="col">
            C
           </th>
           <th scope="col">
            D
           </th>
          </tr>
         </thead>
         <tbody>
          <tr>
           <th scope="row">
            1
           </th>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
          </tr>
          <tr>
           <th scope="row">
            2
           </th>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
          </tr>
          <tr>
           <th scope="row">
            3
           </th>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
          </tr>
          <tr>
           <th scope="row">
            4
           </th>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
           <td contenteditable="true" tabindex="0">
           </td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
      <div class="text-center py-12" id="emptySpreadsheetState">
       <div class="mx-auto w-24 h-24 text-gray-400 mb-4">
        <i class="fas fa-table fa-3x">
        </i>
       </div>
       <h3 class="text-lg font-medium text-gray-900 mb-1">
        Nenhuma planilha selecionada
       </h3>
       <p class="text-gray-500 mb-6">
        Selecione uma planilha existente ou crie uma nova
       </p>
       <button class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" id="createFirstSpreadsheetBtn">
        <i class="fas fa-plus mr-2">
        </i>
        Criar Planilha
       </button>
      </div>
     </section>
     <!-- Add Spreadsheet Modal -->
     <div aria-labelledby="addSpreadsheetModalTitle" aria-modal="true" class="fixed inset-0 overflow-y-auto z-50 hidden" id="addSpreadsheetModal" role="dialog">
      <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
       <div aria-hidden="true" class="fixed inset-0 transition-opacity">
        <div class="absolute inset-0 bg-gray-500 opacity-75">
        </div>
       </div>
       <span aria-hidden="true" class="hidden sm:inline-block sm:align-middle sm:h-screen">
        ​
       </span>
       <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
         <div class="sm:flex sm:items-start">
          <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
           <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4" id="addSpreadsheetModalTitle">
            Criar Nova Planilha
           </h3>
           <div class="mt-2">
            <div class="mb-4">
             <label class="block text-sm font-medium text-gray-700 mb-1" for="spreadsheetName">
              Nome
             </label>
             <input class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="spreadsheetName" type="text"/>
            </div>
            <div class="mb-4">
             <label class="block text-sm font-medium text-gray-700 mb-1" for="spreadsheetArea">
              Área
             </label>
             <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" id="spreadsheetArea">
              <option value="career">
               Carreira
              </option>
              <option value="health">
               Saúde
              </option>
              <option value="finance">
               Finanças
              </option>
              <option value="relationships">
               Relacionamentos
              </option>
              <option value="personal">
               Desenvolvimento Pessoal
              </option>
              <option value="home">
               Casa &amp; Família
              </option>
              <option value="leisure">
               Lazer &amp; Diversão
              </option>
             </select>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
         <button class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm" id="saveSpreadsheetBtnModal" type="button">
          Criar Planilha
         </button>
         <button class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" id="cancelSpreadsheetBtn" type="button">
          Cancelar
         </button>
        </div>
       </div>
      </div>
     </div>
    </main>
   </div>
  </div>
  <script>
   // Elements
    const dashboardView = document.getElementById("dashboardView");
    const tasksView = document.getElementById("tasksView");
    const spreadsheetView = document.getElementById("spreadsheetView");
    const notesView = null; // No notes view in code, so no action for notes links

    // Sidebar links
    const links = document.querySelectorAll(
      'a[href^="#"]:not([href="#"])'
    );

    // Mobile sidebar
    const mobileSidebar = document.getElementById("mobileSidebar");
    const mobileMenuButton = document.getElementById("mobileMenuButton");
    const closeMobileMenu = document.getElementById("closeMobileMenu");

    // User menu
    const userMenuButton = document.getElementById("userMenuButton");
    const userMenu = document.getElementById("userMenu");

    // Modal elements
    const addTaskModal = document.getElementById("addTaskModal");
    const addTaskBtn = document.getElementById("addTaskBtn");
    const cancelTaskBtn = document.getElementById("cancelTaskBtn");
    const saveTaskBtn = document.getElementById("saveTaskBtn");

    const addSpreadsheetModal = document.getElementById("addSpreadsheetModal");
    const addSpreadsheetBtn = document.getElementById("addSpreadsheetBtn");
    const cancelSpreadsheetBtn = document.getElementById("cancelSpreadsheetBtn");
    const saveSpreadsheetBtnModal = document.getElementById("saveSpreadsheetBtnModal");

    const spreadsheetEditor = document.getElementById("spreadsheetEditor");
    const spreadsheetList = document.getElementById("spreadsheetList");
    const spreadsheetTitle = document.getElementById("spreadsheetTitle");
    const closeSpreadsheetBtn = document.getElementById("closeSpreadsheetBtn");

    // Views map for easy switching
    const views = {
      dashboard: dashboardView,
      tarefas: tasksView,
      planilhas: spreadsheetView,
      notas: null, // No notes view implemented
      carreira: null,
      saude: null,
      financas: null,
      relacionamentos: null,
      desenvolvimento: null,
      "casa-familia": null,
      "lazer-diversao": null,
    };

    // Function to hide all main views
    function hideAllViews() {
      Object.values(views).forEach((view) => {
        if (view) view.classList.add("hidden");
      });
      // Also hide spreadsheet editor and empty state
      spreadsheetEditor.classList.add("hidden");
      document.getElementById("emptySpreadsheetState").classList.remove("hidden");
    }

    // Function to activate a link style in sidebar
    function activateLink(hash) {
      // Remove active classes from all sidebar links
      document.querySelectorAll(".area-link, #tasksTabLink, #spreadsheetTabLink, #notesTabLink").forEach((el) => {
        el.classList.remove("text-indigo-700", "bg-indigo-50");
        el.classList.add("text-gray-600", "hover:text-gray-900", "hover:bg-gray-50");
      });
      document.querySelectorAll("#mobileLifeAreas a, #mobileTasksTabLink, #mobileSpreadsheetTabLink, #mobileNotesTabLink").forEach((el) => {
        el.classList.remove("text-indigo-700", "bg-indigo-50");
        el.classList.add("text-gray-600", "hover:text-gray-900", "hover:bg-gray-50");
      });

      // Find all links with matching href and activate them
      document.querySelectorAll(`a[href="${hash}"]`).forEach((el) => {
        el.classList.add("text-indigo-700", "bg-indigo-50");
        el.classList.remove("text-gray-600", "hover:text-gray-900", "hover:bg-gray-50");
      });
    }

    // Function to show view by hash
    function showViewByHash(hash) {
      hideAllViews();

      if (hash === "#dashboard" || hash === "") {
        dashboardView.classList.remove("hidden");
      } else if (hash === "#tarefas") {
        tasksView.classList.remove("hidden");
      } else if (hash === "#planilhas") {
        spreadsheetView.classList.remove("hidden");
      } else if (hash === "#notas") {
        // No notes view implemented, fallback to dashboard
        dashboardView.classList.remove("hidden");
      } else if (
        [
          "#carreira",
          "#saude",
          "#financas",
          "#relacionamentos",
          "#desenvolvimento",
          "#casa-familia",
          "#lazer-diversao",
        ].includes(hash)
      ) {
        // For life areas, show dashboard with filtered content or just dashboard for now
        dashboardView.classList.remove("hidden");
      } else {
        // Default fallback
        dashboardView.classList.remove("hidden");
      }

      activateLink(hash);
    }

    // Handle clicks on sidebar links to update hash and show views
    links.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const href = link.getAttribute("href");
        if (href) {
          history.pushState(null, "", href);
          showViewByHash(href);
          // Close mobile menu if open
          if (!mobileSidebar.classList.contains("hidden")) {
            toggleMobileMenu(false);
          }
        }
      });
    });

    // Handle browser back/forward navigation
    window.addEventListener("popstate", () => {
      showViewByHash(location.hash);
    });

    // Initial load
    showViewByHash(location.hash);

    // Mobile menu toggle
    function toggleMobileMenu(show) {
      if (show) {
        mobileSidebar.classList.remove("hidden");
        mobileSidebar.focus();
      } else {
        mobileSidebar.classList.add("hidden");
        mobileMenuButton.focus();
      }
    }

    mobileMenuButton.addEventListener("click", () => {
      toggleMobileMenu(true);
    });

    closeMobileMenu.addEventListener("click", () => {
      toggleMobileMenu(false);
    });

    // User menu toggle
    userMenuButton.addEventListener("click", () => {
      userMenu.classList.toggle("hidden");
    });

    // Close user menu if clicked outside
    document.addEventListener("click", (e) => {
      if (
        !userMenu.contains(e.target) &&
        !userMenuButton.contains(e.target)
      ) {
        userMenu.classList.add("hidden");
      }
    });

    // Add Task Modal open/close
    addTaskBtn.addEventListener("click", () => {
      addTaskModal.classList.remove("hidden");
      document.getElementById("taskTitle").focus();
    });

    cancelTaskBtn.addEventListener("click", () => {
      addTaskModal.classList.add("hidden");
      addTaskBtn.focus();
    });

    // Save Task (dummy implementation)
    saveTaskBtn.addEventListener("click", () => {
      // Here you would add the task to the list or backend
      alert("Tarefa salva (simulação).");
      addTaskModal.classList.add("hidden");
      addTaskBtn.focus();
    });

    // Add Spreadsheet Modal open/close
    addSpreadsheetBtn.addEventListener("click", () => {
      addSpreadsheetModal.classList.remove("hidden");
      document.getElementById("spreadsheetName").focus();
    });

    cancelSpreadsheetBtn.addEventListener("click", () => {
      addSpreadsheetModal.classList.add("hidden");
      addSpreadsheetBtn.focus();
    });

    saveSpreadsheetBtnModal.addEventListener("click", () => {
      // Here you would add the spreadsheet to the list or backend
      alert("Planilha criada (simulação).");
      addSpreadsheetModal.classList.add("hidden");
      addSpreadsheetBtn.focus();
    });

    // Spreadsheet list click to open editor
    spreadsheetList.querySelectorAll("[data-spreadsheet]").forEach((el) => {
      el.addEventListener("click", () => {
        openSpreadsheetEditor(el.dataset.spreadsheet);
      });
      el.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          openSpreadsheetEditor(el.dataset.spreadsheet);
        }
      });
    });

    function openSpreadsheetEditor(name) {
      // Show spreadsheet view and editor
      hideAllViews();
      spreadsheetView.classList.remove("hidden");
      spreadsheetEditor.classList.remove("hidden");
      document.getElementById("emptySpreadsheetState").classList.add("hidden");
      spreadsheetTitle.textContent = formatSpreadsheetName(name);
      closeSpreadsheetBtn.focus();
    }

    function formatSpreadsheetName(name) {
      // Simple formatting for demonstration
      return name
        .replace(/-/g, " ")
        .replace(/\b\w/g, (l) => l.toUpperCase());
    }

    closeSpreadsheetBtn.addEventListener("click", () => {
      spreadsheetEditor.classList.add("hidden");
      document.getElementById("emptySpreadsheetState").classList.remove("hidden");
      spreadsheetTitle.textContent = "Nova Planilha";
    });

    // View all tasks button navigates to tasks tab
    document.getElementById("viewAllTasksBtn").addEventListener("click", (e) => {
      e.preventDefault();
      history.pushState(null, "", "#tarefas");
      showViewByHash("#tarefas");
    });

    // View all notes button navigates to notes tab (no notes view, fallback dashboard)
    document.getElementById("viewAllNotesBtn").addEventListener("click", (e) => {
      e.preventDefault();
      history.pushState(null, "", "#notas");
      showViewByHash("#notas");
    });

    // Accessibility: trap focus inside modals when open
    function trapFocus(element) {
      const focusableElements =
        'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]';
      const firstFocusableElement = element.querySelectorAll(focusableElements)[0];
      const focusableContent = element.querySelectorAll(focusableElements);
      const lastFocusableElement = focusableContent[focusableContent.length - 1];

      element.addEventListener("keydown", function (e) {
        let isTabPressed = e.key === "Tab" || e.keyCode === 9;

        if (!isTabPressed) {
          return;
        }

        if (e.shiftKey) {
          // shift + tab
          if (document.activeElement === firstFocusableElement) {
            lastFocusableElement.focus();
            e.preventDefault();
          }
        } else {
          // tab
          if (document.activeElement === lastFocusableElement) {
            firstFocusableElement.focus();
            e.preventDefault();
          }
        }
      });
    }

    trapFocus(addTaskModal);
    trapFocus(addSpreadsheetModal);

    // Close modals on Escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        if (!addTaskModal.classList.contains("hidden")) {
          addTaskModal.classList.add("hidden");
          addTaskBtn.focus();
        }
        if (!addSpreadsheetModal.classList.contains("hidden")) {
          addSpreadsheetModal.classList.add("hidden");
          addSpreadsheetBtn.focus();
        }
        if (!mobileSidebar.classList.contains("hidden")) {
          toggleMobileMenu(false);
        }
      }
    });
  </script>
 </body>
</html>
